<Window x:Class="ImageDescriber.Full.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ImageDescriber.Full"
        mc:Ignorable="d"
        Title="ImageDescriber" Height="700" Width="1000" MinHeight="600" MinWidth="800">

    <Window.Resources>
        <!-- Converters for data binding -->
        <local:FilePathToImageSourceConverter x:Key="FilePathToImageSourceConverter"/>
        <local:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </Window.Resources>

    <DockPanel>
        <!-- Menu Bar - NOT in tab order as requested -->
        <MenuBar DockPanel.Dock="Top" IsTabStop="False">
            <MenuItem Header="_File">
                <MenuItem Header="_New Workspace" Command="{Binding NewWorkspaceCommand}" InputGestureText="Ctrl+N"/>
                <MenuItem Header="_Open Workspace..." Command="{Binding OpenWorkspaceCommand}" InputGestureText="Ctrl+O"/>
                <MenuItem Header="_Save Workspace" Command="{Binding SaveWorkspaceCommand}" InputGestureText="Ctrl+S"/>
                <MenuItem Header="Save Workspace _As..." Command="{Binding SaveWorkspaceAsCommand}"/>
                <Separator/>
                <MenuItem Header="Add _Directory..." Command="{Binding AddDirectoryCommand}"/>
                <MenuItem Header="Add _Files..." Command="{Binding AddFilesCommand}"/>
                <Separator/>
                <MenuItem Header="E_xit" Command="{Binding ExitCommand}"/>
            </MenuItem>
            <MenuItem Header="_Edit">
                <MenuItem Header="_Copy Description" Command="{Binding CopyDescriptionCommand}" InputGestureText="Ctrl+C"/>
                <MenuItem Header="_Edit Description..." Command="{Binding EditDescriptionCommand}"/>
                <MenuItem Header="_Delete Description" Command="{Binding DeleteDescriptionCommand}" InputGestureText="Delete"/>
            </MenuItem>
            <MenuItem Header="_Process">
                <MenuItem Header="Process _Selected Image" Command="{Binding ProcessSelectedCommand}" InputGestureText="P"/>
                <MenuItem Header="Process _Batch" Command="{Binding ProcessBatchCommand}" InputGestureText="B"/>
                <MenuItem Header="_Stop Processing" Command="{Binding StopProcessingCommand}" InputGestureText="Esc"/>
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="_About" Command="{Binding AboutCommand}"/>
            </MenuItem>
        </MenuBar>
        
        <!-- Status Bar -->
        <StatusBar DockPanel.Dock="Bottom">
            <StatusBarItem>
                <TextBlock Text="{Binding StatusMessage}" 
                          AutomationProperties.Name="Status Message"
                          AutomationProperties.HelpText="Current operation status"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{Binding ProgressText}" Margin="0,0,10,0"/>
                    <ProgressBar Width="150" Height="16" Value="{Binding ProgressValue}" Maximum="100" 
                               Visibility="{Binding IsProcessing, Converter={StaticResource BoolToVisibilityConverter}}"/>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>

        <!-- Main Content - Exact Python Qt6 Layout: Two-Panel Horizontal Splitter -->
        <Grid DockPanel.Dock="Top">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="400" MinWidth="200"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="*" MinWidth="300"/>
            </Grid.ColumnDefinitions>

            <!-- LEFT PANEL - Images List (exactly like Python Qt6) -->
            <DockPanel Grid.Column="0">
                <!-- Images Header -->
                <TextBlock DockPanel.Dock="Top" Text="Images:" FontWeight="Bold" Margin="5" 
                          Background="LightGray" Padding="5"/>
                
                <!-- Batch Info at Bottom -->
                <TextBlock DockPanel.Dock="Bottom" Text="{Binding BatchInfo}" Margin="5" 
                          AutomationProperties.Name="Batch Queue Status"/>
                
                <!-- Images ListBox - Main Content -->
                <ListBox ItemsSource="{Binding WorkspaceImages}"
                        SelectedItem="{Binding SelectedImageItem}"
                        AutomationProperties.Name="Image List"
                        AutomationProperties.HelpText="List of images and video frames in the workspace. Use arrow keys to navigate, P to process selected image, B to mark for batch.">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Margin="2">
                                <!-- Status Prefix (âœ“ for batch marked) -->
                                <TextBlock Text="{Binding StatusPrefix}" FontWeight="Bold" 
                                          Foreground="Green" Width="15"/>
                                <!-- File Name -->
                                <TextBlock Text="{Binding FileName}"/>
                                <!-- Description Count -->
                                <TextBlock Text="{Binding DescriptionCount, StringFormat=' ({0})'}" 
                                          Foreground="Gray" Margin="5,0,0,0"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </DockPanel>

            <!-- Vertical Splitter -->
            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>

            <!-- RIGHT PANEL - Descriptions (exactly like Python Qt6) -->
            <DockPanel Grid.Column="2">
                <!-- Descriptions Header -->
                <TextBlock DockPanel.Dock="Top" Text="Descriptions:" FontWeight="Bold" Margin="5" 
                          Background="LightGray" Padding="5"/>
                
                <!-- Description Text Area at Bottom -->
                <DockPanel DockPanel.Dock="Bottom" Height="200" MinHeight="100">
                    <TextBlock DockPanel.Dock="Top" Text="Description Text:" FontWeight="Bold" 
                              Margin="5" Background="LightGray" Padding="5"/>
                    <TextBox Text="{Binding SelectedDescription.Text, Mode=OneWay}" 
                            IsReadOnly="True" 
                            TextWrapping="Wrap" 
                            VerticalScrollBarVisibility="Auto" 
                            Margin="5"
                            AutomationProperties.Name="Description Text"
                            AutomationProperties.HelpText="Displays the full image description. Use arrow keys to navigate through the text."/>
                </DockPanel>
                
                <!-- Descriptions ListBox - Main Content -->
                <ListBox ItemsSource="{Binding SelectedImageDescriptions}"
                        SelectedItem="{Binding SelectedDescription}"
                        Margin="5"
                        AutomationProperties.Name="Description List"
                        AutomationProperties.HelpText="List of descriptions for the selected image. Use arrow keys to navigate and view different descriptions.">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Margin="2">
                                <!-- Model and Provider Info -->
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Model}" FontWeight="Bold" FontSize="12"/>
                                    <TextBlock Text="{Binding Provider, StringFormat=' ({0})'}" 
                                              FontSize="10" Foreground="Blue" Margin="5,0,0,0"/>
                                </StackPanel>
                                <!-- Truncated Description Text -->
                                <TextBlock Text="{Binding Text}" TextWrapping="Wrap" 
                                          MaxHeight="50" TextTrimming="CharacterEllipsis" 
                                          FontSize="11" Margin="0,2,0,0"/>
                                <!-- Created Date -->
                                <TextBlock Text="{Binding Created}" FontSize="9" 
                                          Foreground="Gray" Margin="0,2,0,0"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </DockPanel>
        </Grid>
    </DockPanel>
</Window>